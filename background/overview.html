<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Overview of Chemist &mdash; Chemist v1.2.11 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=1da0032b"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Terminology and Abbreviations" href="terminology.html" />
    <link rel="prev" title="Statement of Need" href="statement_of_need.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v1.2.11
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing Chemist</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Chemist Background</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="motivation.html">Chemist Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="statement_of_need.html">Statement of Need</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Overview of Chemist</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tl-dr">TL;DR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-vs-dsl">Input vs. DSL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-can-you-do-with-chemist-s-dsl">What can you do with Chemist’s DSL?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-does-the-software-stack-look-like-using-chemist">What does the software stack look like using Chemist?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-is-a-typical-chemist-workflow">What is a typical Chemist workflow?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="terminology.html">Terminology and Abbreviations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Chemist Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex.github.io/Chemist/chemist_cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Chemist</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Chemist Background</a></li>
      <li class="breadcrumb-item active">Overview of Chemist</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/background/overview.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="overview-of-chemist">
<h1>Overview of Chemist<a class="headerlink" href="#overview-of-chemist" title="Link to this heading"></a></h1>
<p>As discussed in <a class="reference internal" href="statement_of_need.html#statement-of-need"><span class="std std-ref">Statement of Need</span></a> the ultimate goal of Chemist can be
summarized as a performant <a class="reference internal" href="terminology.html#term-DSL"><span class="xref std std-term">DSL</span></a> for expressing computational chemistry
calculations. This page summarizes how this goal is achieved in Chemist.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For simplicity version 1.0 of Chemist will limit its focus to Gaussian-based
quantum chemistry (including <a class="reference internal" href="terminology.html#term-DFT"><span class="xref std std-term">DFT</span></a>). That said, care has been taken in
designing Chemist to ensure that it can be expanded to other computational
chemistry techniques down the road.</p>
</div>
<section id="tl-dr">
<h2>TL;DR<a class="headerlink" href="#tl-dr" title="Link to this heading"></a></h2>
<p>Chemist provides performant classes which make it easy to express and compose
computational chemistry calculations. This is done with unprecedented fine-
grained control and without compromising performance. Custom operator
partitions, remove/delete operator terms, freeze wavefunction parameters — all
possible without needing to modify algorithm code (assuming the consuming code
supports the request). Downstream codes can avoid the need for a large number
of logic branches by just looping over the provided terms. This makes it
particularly easy to mix and match pieces of different methods without having
to introduce downstream logic.</p>
</section>
<section id="input-vs-dsl">
<h2>Input vs. DSL<a class="headerlink" href="#input-vs-dsl" title="Link to this heading"></a></h2>
<p>If you already have experience with other computational chemistry packages you
are probably used to thinking of the input to a computational chemistry
package as specifying:</p>
<ul class="simple">
<li><p>the chemical system of interest (e.g., the Cartesian coordinates),</p></li>
<li><p>the level of theory (i.e., method and atomic basis set), and</p></li>
<li><p>a series of options (usually key/value pairs).</p></li>
</ul>
<p>Most legacy codes require the user to specify the above in a text file which
then gets parsed. More modern codes usually provide mechanisms for specifying
the above programatically (such as in a Python script), but it’s still usually
specified as string-based input. Regardless of the actual input mechanism, what
we just described is the <a class="reference internal" href="terminology.html#term-UI"><span class="xref std std-term">UI</span></a> of the software package.</p>
<p>UIs are designed to ensure that the user can easily specify their intent. In
practice, this usually is accomplished by relying on implicit state. More
specifically, many packages rely on small amounts of human-readable text to
convey very complicated ideas. A familiar example is specifying the atomic basis
set; typically this is done by providing a string like <code class="docutils literal notranslate"><span class="pre">cc-pVDZ</span></code>. The
implicit state stems from the fact that the code must know how to convert from
the user’s input string to the actual exponents and coefficients comprising the
molecular basis set. In other words, the literal string <code class="docutils literal notranslate"><span class="pre">cc-pVDZ</span></code> does NOT
contain the explicit information the code needs.</p>
<p>Compared to the UI just described, the DSL contained in Chemist is much more
explicit. This is because classes comprising the DSL, like <code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code>,
actually contain the parameters for the concepts they represent. In turn,
developers can simply prepare objects in whatever state they want (as opposed
to for example requiring extensions to the UI to handle say assigning different
atomic basis sets to different atoms). The real power of a DSL like Chemist is
in that routines which work with Chemist objects don’t need to understand
strings like <code class="docutils literal notranslate"><span class="pre">cc-pVDZ</span></code> they just work with the data provided.</p>
</section>
<section id="what-can-you-do-with-chemist-s-dsl">
<h2>What can you do with Chemist’s DSL?<a class="headerlink" href="#what-can-you-do-with-chemist-s-dsl" title="Link to this heading"></a></h2>
<p>Admittedly basis set manipulations can be done through the UI of many existing
computational chemistry packages, and are thus not a compelling proof of the
Chemist DSL’s power. Rather we note that the Chemist DSL enables:</p>
<ul class="simple">
<li><p>Custom Hamiltonian/Fock operators. Want extra terms? Just add them. Neglect
the interactions between two atoms? Delete them.</p></li>
<li><p>Custom operator partitionings. Want to know the total kinetic energy from a
subset of the system? Split the total kinetic energy operator in two.</p></li>
<li><p>Fine-grained control of wavefunction parameters. Want to freeze some? Just
partition the wavefunction object.</p></li>
<li><p>Want to support the above features? Rely on the Chemist DSL as input instead
of a combinatorial number of “Enable feature X” options.</p></li>
</ul>
<p>Keep in mind, all of the above is possible without compromising performance
because:</p>
<ul class="simple">
<li><p>Chemist is simply a series of data structures. Computations access the data
from the data structures however they need to for performance.</p></li>
<li><p>Chemist facilitates use of data in native formats. No need for copying,
or serializing. Just create a “view” of your existing data structure.</p></li>
<li><p>Chemist is written in modern C++17 which allows many low-level optimizations
that are not possible in interpreted languages.</p></li>
<li><p>Chemist has Python bindings. All the rapid-prototyping Python workflows
developer have come to love are now actually done with production-quality
operators.</p></li>
</ul>
<p>Two disclaimers. First, many of the above features are experimental. Second,
Chemist is just a DSL, i.e., it allows you to express intent and you still
need to actually write algorithms to carry out the expressed calculations. For
example just because you turned relativity on for a particular atom, doesn’t
mean the software package automatically now knows how to solve the Dirac
equation. That said, many codes out there already contain kernels capable of
performantly computing each term, but they lack a mechanism for easily composing
those terms. That’s where Chemist’s DSL shines: by allowing the developer to
compose existing kernels as they see fit.</p>
</section>
<section id="what-does-the-software-stack-look-like-using-chemist">
<h2>What does the software stack look like using Chemist?<a class="headerlink" href="#what-does-the-software-stack-look-like-using-chemist" title="Link to this heading"></a></h2>
<p>In short, for most computational chemistry activities users will continue to
use UIs. The UI input will then be mapped to the Chemist DSL, and then the
Chemist DSL will be mapped to the underlying kernels. Most legacy computational
chemistry packages forego the intermediate DSL layer. The problem with such an
approach is that the DSL is exactly the interface power users/developers are
looking for. Without the DSL, said users are forced to modify the existing code
or complicate the UI.</p>
</section>
<section id="what-is-a-typical-chemist-workflow">
<h2>What is a typical Chemist workflow?<a class="headerlink" href="#what-is-a-typical-chemist-workflow" title="Link to this heading"></a></h2>
<figure class="align-center" id="id1">
<span id="fig-gaussian-input"></span><img alt="../_images/gaussian_input.png" src="../_images/gaussian_input.png" />
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Traditional workflow of a Gaussian-based quantum chemistry method.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The typical Chemist workflow is pictorially given in
<a class="reference internal" href="#fig-gaussian-input"><span class="std std-numref">Fig. 1</span></a> (in the context of Gaussian-based quantum
chemistry). The first step is to create a <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> class (TODO: link).
For the example workflow shown in <a class="reference internal" href="#fig-gaussian-input"><span class="std std-numref">Fig. 1</span></a> this step is
depicted by the benzene molecule. The <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> class describes the
nuclei, electrons, molecules, boundary conditions (periodic, vacuum, solvent,
etc.), and fields that represent the <a class="reference internal" href="terminology.html#term-chemical-system"><span class="xref std std-term">chemical system</span></a> of interest. The
<code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> is the chemist’s view of the problem.</p>
<p>Given a <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> the next step is to create a physical model of the
system. For Gaussian-based quantum chemistry this has two parts creating a
molecular basis set (pictorially represented in <a class="reference internal" href="#fig-gaussian-input"><span class="std std-numref">Fig. 1</span></a>
by the <em>p</em>-orbitals superimposed on benzene) and specifying an approximation
to the Schroedinger equation (pictorially represented in
<a class="reference internal" href="#fig-gaussian-input"><span class="std std-numref">Fig. 1</span></a> by the time-independent Schroedinger equation). In
Chemist we rely on the <code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code> class for describing molecular basis sets
and a combination of <code class="docutils literal notranslate"><span class="pre">Operator</span></code> and <code class="docutils literal notranslate"><span class="pre">Wavefunction</span></code> objects to express the
physical approximations (disclaimer <code class="docutils literal notranslate"><span class="pre">Operator</span></code> and <code class="docutils literal notranslate"><span class="pre">Wavefunction</span></code> are
still experimental).</p>
<p>Together the <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code>, <code class="docutils literal notranslate"><span class="pre">Operator</span></code>, and <code class="docutils literal notranslate"><span class="pre">Wavefunction</span></code> objects
provide an explicit representation of what the user wants to do. The last step
shown in <a class="reference internal" href="#fig-gaussian-input"><span class="std std-numref">Fig. 1</span></a> is the actual computation of the user’s
requested quantity depicted as pseudocode. Ideally, the computations will
leverage Chemists’s data structures directly to avoid expensive data
transformations, but Chemist also provides mechanisms for accessing the
underlying data in a variety of formats.</p>
<p>While Chemist is a standalone library providing a computational chemistry DSL,
the developers of Chemist feel that it particularly shines when it used to
define interfaces for modular software. The workflow in this section assumes
such a use case by relying on opaque modular functions. In the NWChemEx stack
these modular functions are actually
<a class="reference external" href="https://github.com/NWChemEx/PluginPlay">PluginPlay</a> modules; however,
Chemist is independent of PluginPlay and any function satisfying the APIs used
here will work. Pseudocode for the above workflow is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// N.B. all opaque functions would need more user input to work</span>
<span class="n">ChemicalSystem</span><span class="w"> </span><span class="n">benzene</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_molecule_from_ui</span><span class="p">();</span>
<span class="n">AOBasisSet</span><span class="w"> </span><span class="n">aos</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">form_molecular_basis_set</span><span class="p">(</span><span class="n">benzene</span><span class="p">);</span>
<span class="k">auto</span><span class="w"> </span><span class="n">H</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="n">form_hamiltonian</span><span class="p">(</span><span class="n">benzene</span><span class="p">,</span><span class="w"> </span><span class="n">aos</span><span class="p">);</span>
<span class="k">auto</span><span class="w"> </span><span class="n">Psi</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="n">compute_wavefunction</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">aos</span><span class="p">);</span>
<span class="kt">double</span><span class="w"> </span><span class="n">E</span><span class="w">               </span><span class="o">=</span><span class="w"> </span><span class="n">compute_energy</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">Psi</span><span class="p">);</span>
</pre></div>
</div>
<p>Of note, see how data is passed explicitly. This avoids coupling to global state
or implicit definitions of things like “Hartree-Fock”. With this code we don’t
have to wonder “what the user things Hartree-Fock is?” because we’re given an
explicit Hamiltonian (as a slight aside many developers may not be used to
thinking of Hartree-Fock in terms of Hamiltonians, but rather Fock operators;
however, Hartree-Fock can be viewed as approximating the Hamiltonian as the core
Hamiltonian plus the converged Fock operator). It’s also important to note that
the DSL does not actually do any computations, it just describes what the user
wants to do. The point being it is not actually possible to talk to the
efficiency of the above code because the bottleneck computations are wrapped in
the opaque functions, e.g., while many developers may immediately say the
iterative nature of Hartree-Fock means that the above code would need to solve
the Hartree-Fock equations 3 times (once in <code class="docutils literal notranslate"><span class="pre">form_hamiltonian</span></code>, once in
<code class="docutils literal notranslate"><span class="pre">compute_wavefunction</span></code>, and once in <code class="docutils literal notranslate"><span class="pre">compute_energy</span></code>); we argue (and the
experimental NWChemEx SCF implementation proves) this need not be the case.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="statement_of_need.html" class="btn btn-neutral float-left" title="Statement of Need" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="terminology.html" class="btn btn-neutral float-right" title="Terminology and Abbreviations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, NWChemEx Community.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>