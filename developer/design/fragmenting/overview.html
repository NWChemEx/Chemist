<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Designing the Fragmenting Component &mdash; Chemist v1.3.19 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=2cf50c3e"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Designing the FragmentedBase Class" href="fragmented_base.html" />
    <link rel="prev" title="Design of the Fragmenting Component" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v1.3.19
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installing Chemist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../background/index.html">Chemist Background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Design Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../architecture.html">Architecture of Chemist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chemical_system/index.html">Design of the Chemical System Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ao_basis_set/index.html">Design of the AO Basis Set Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topology/index.html">Design of the Topology Component</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Design of the Fragmenting Component</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Designing the Fragmenting Component</a></li>
<li class="toctree-l4"><a class="reference internal" href="fragmented_base.html">Designing the FragmentedBase Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="capping/index.html">Capping Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="fragmented_nuclei.html">Designing the FragmentedNuclei Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="fragmented_molecule.html">Designing the FragmentedMolecule Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="fragmented_chemical_system.html">Designing the FragmentedChemicalSystem Class</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quantum_mechanics/index.html">Design of the Quantum Mechanics (QM) Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dsl.html">DSL Component</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developing_the_chemical_system_component.html">Developing the Chemical System Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../writing_views.html">Creating a New View</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../the_traits_component.html">Understanding the Traits Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../adding_an_operator.html">Notes on Adding an Operator</a></li>
<li class="toctree-l2"><a class="reference external" href="https://nwchemex.github.io/.github/">NWChemEx author documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Chemist Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex.github.io/Chemist/chemist_cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Chemist</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Developer Documentation</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Design Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Design of the Fragmenting Component</a></li>
      <li class="breadcrumb-item active">Designing the Fragmenting Component</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developer/design/fragmenting/overview.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="designing-the-fragmenting-component">
<span id="id1"></span><h1>Designing the Fragmenting Component<a class="headerlink" href="#designing-the-fragmenting-component" title="Link to this heading"></a></h1>
<p>This page records the high-level design decisions which went into Chemist’s
Fragmenting component.</p>
<section id="what-is-the-fragmenting-component">
<h2>What is the Fragmenting Component?<a class="headerlink" href="#what-is-the-fragmenting-component" title="Link to this heading"></a></h2>
<p>Most computational chemistry energy methods compute the energy of a target
<a class="reference internal" href="../../../background/terminology.html#term-chemical-system"><span class="xref std std-term">chemical system</span></a>. Some methods do this by breaking the target chemical
system into pieces. Each piece, or “<a class="reference internal" href="../../../background/terminology.html#term-fragment"><span class="xref std std-term">fragment</span></a>” is meant to simulate a
subset of the target system (the target system is often called the
“supersystem” to emphasize the sub-/super-set relationship of the two).
Chemist’s Fragmenting component is charged with providing classes for
representing fragments.</p>
</section>
<section id="why-do-we-need-a-fragmenting-component">
<h2>Why Do We Need a Fragmenting Component?<a class="headerlink" href="#why-do-we-need-a-fragmenting-component" title="Link to this heading"></a></h2>
<p>In addition to fragment-based methods, i.e., methods which approximate the
target system’s properties via the (generalized) many-body expansion, methods
such as <a class="reference internal" href="../../../background/terminology.html#term-QM-MM"><span class="xref std std-term">QM/MM</span></a> and <a class="reference internal" href="../../../background/terminology.html#term-ONIOM"><span class="xref std std-term">ONIOM</span></a> also rely on sub-/super-set
relationships. We thus will have a need to represent these sub-/super-set
relationships in the inputs/outputs to algorithms. The fragmenting component is
charged with providing the user with the classes needed to express these
relationships.</p>
<p>For many people the next question may be “why do we need a whole component for
this vs. say just using <code class="docutils literal notranslate"><span class="pre">std::vector&lt;Molecule&gt;</span></code> objects?” The answer is
performance. Particularly for large supersystems the number of subsets can be
very large (n.b., the number of terms in the full <a class="reference internal" href="../../../background/terminology.html#term-MBE"><span class="xref std std-term">MBE</span></a> grows
exponentially in the number of subsets). Storing all of those subsets as
individual objects requires a large amount of memory and leads to inefficient
operations, e.g., using <code class="docutils literal notranslate"><span class="pre">Molecule::operator==</span></code> will compare the full state,
but since the subsets contain atoms from the same superset, we can get by with
determining if say atom 1 is in both sets. Ultimately, as described in the
next section, the fragmenting component will need to parallel the chemical
system component (and potentially other Chemist components) and we have thus
opted to decuple fragmenting from the component(s) being fragmented.</p>
</section>
<section id="fragmenting-considerations">
<h2>Fragmenting Considerations<a class="headerlink" href="#fragmenting-considerations" title="Link to this heading"></a></h2>
<dl class="simple" id="fc-chemical-system-class">
<dt>chemical system class</dt><dd><p>Most fragments stem from decomposing a <a class="reference internal" href="../../../background/terminology.html#term-chemical-system"><span class="xref std std-term">chemical system</span></a>. In Chemist,
chemical systems are modeled by the <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> class and thus
fragments should be defined with respect to a <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> object.</p>
<ul class="simple">
<li><p>As a corollary, we also want fragments of a <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> to be usable
wherever <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> objects are used.</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="fc-chemical-system-hierarchy">
<dt>chemical system hierarchy</dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> class is actually a hierarchy of classes. Conceptually
the easiest way to fragment a <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> object is to fragment it
piece-by-piece, i.e., we expect users to first fragment the <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code>
within the <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code>, then assign electrons to those <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code>
objects to make <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> objects, and then assign external fields to
the <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> objects to create <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> objects.</p>
<ul class="simple">
<li><p>Similar to <a class="reference internal" href="#fc-chemical-system-class"><span class="std std-ref">chemical system class</span></a> we want fragments of <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code>
and <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> objects to be usable wherever <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> and <code class="docutils literal notranslate"><span class="pre">Molecule</span></code>
objects are usable.</p></li>
</ul>
</dd>
</dl>
<dl id="fc-caps">
<dt>caps</dt><dd><blockquote>
<div><p>When the supersystem contains large covalently-bonded molecules, fragments
will usually severe covalent bonds. One of the most common strategies for
dealing with this is to “cap” the broken bond with a monovalent atom (or
sometimes set of atoms).</p>
</div></blockquote>
<ul class="simple">
<li><p>When a fragment is passed to an algorithm meant for a traditional
<code class="docutils literal notranslate"><span class="pre">Nuclei</span></code>, <code class="docutils literal notranslate"><span class="pre">Molecule</span></code>, or <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> which elements come from
caps and which come from the supersystem is irrelevant; however, this
changes for algorithms needing to assemble the resulting properties.</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="fc-non-disjoint">
<dt>non-disjoint fragments</dt><dd><p>Historically fragments have resulted from partitioning the supersystem, i.e.,
each nucleus appears in one, and only one, fragment. More recently methods
which rely on non-disjoint fragments have been developed too. The
Fragmenting component should avoid assuming that fragments are disjoint.</p>
</dd>
</dl>
<dl class="simple" id="fc-general-use">
<dt>general use</dt><dd><p>As motivated above, a number of methods require fragmenting a
<code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> object. The Fragmenting component should avoid assuming
a particular method of fragmentation strategy.</p>
</dd>
</dl>
<section id="out-of-scope">
<h3>Out of Scope<a class="headerlink" href="#out-of-scope" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>n-mers</dt><dd><p>A lot of (generalized) many-body expansion methods distinguish between
fragments and unions of fragments (an “n-mer” being the union of n
fragments). In practice, if one views a set of n-mers as set of non-disjoint
fragments, the “n-mer” distinction becomes somewhat immaterial. Thus,
because of the <a class="reference internal" href="#fc-non-disjoint"><span class="std std-ref">non-disjoint fragments</span></a> consideration we feel that the
Fragmenting component does not need to distinguish between fragments and
n-mers.</p>
</dd>
<dt>Expansion coefficients.</dt><dd><p>Usually the properties of the fragments are combined as a linear combination.
The weights of this linear expansion will be stored elsewhere. Part of the
motivation for not including the weights here is that in many cases the
weights depend on more than just the fragment/field, <em>e.g.</em>, they may also
depend on the AO basis set (think basis set superposition error corrections)
and/or level of theory (think <a class="reference internal" href="../../../background/terminology.html#term-QM-MM"><span class="xref std std-term">QM/MM</span></a> or other multi-layered theories).</p>
</dd>
</dl>
</section>
</section>
<section id="fragmenting-api">
<span id="id2"></span><h2>Fragmenting API<a class="headerlink" href="#fragmenting-api" title="Link to this heading"></a></h2>
<p>Most fragmentation workflows start with an already created <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code>
class and then fragment that. Below is the proposed workflow and APIs for
fragmenting a <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code>.</p>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Opaquely creates the system to fragment</span>
<span class="n">ChemicalSystem</span><span class="w"> </span><span class="n">sys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_chemical_system</span><span class="p">();</span>

<span class="c1">// Step 1. We start by assigning nuclei to fragments.</span>

<span class="c1">// This will be the sets of nuclei in each fragment</span>
<span class="n">FragmentedNuclei</span><span class="w"> </span><span class="nf">frag_nuclei</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">molecule</span><span class="p">().</span><span class="n">nuclei</span><span class="p">());</span>

<span class="c1">// Usually assigning nuclei to fragments is much more complicated than this</span>
<span class="c1">// but for illustrative purposes we just make each fragment a single nucleus</span>
<span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">mol</span><span class="p">.</span><span class="n">nuclei</span><span class="p">().</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">){</span>
<span class="w">    </span><span class="n">frag_nuclei</span><span class="p">.</span><span class="n">insert</span><span class="p">({</span><span class="n">i</span><span class="p">});</span>
<span class="p">}</span>

<span class="c1">// Step 2. In many cases fragmenting will break covalent bonds and we will</span>
<span class="c1">// need to cap the nuclei.</span>

<span class="c1">// For demonstrative purposes we assume that there was only a bond between</span>
<span class="c1">// nuclei 0 and 1 that needs capped</span>
<span class="n">frag_nuclei</span><span class="p">.</span><span class="n">add_cap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nucleus</span><span class="p">{...});</span><span class="w"> </span><span class="c1">// Cap attached to 0, replacing 1</span>
<span class="n">frag_nuclei</span><span class="p">.</span><span class="n">add_cap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Nucleus</span><span class="p">{...});</span><span class="w"> </span><span class="c1">// Cap attached to 1, replacing 0</span>

<span class="c1">// Step 3. Need to assign electrons to the fragments</span>

<span class="c1">// This will hold the &quot;Molecule&quot; piece of each fragment</span>
<span class="n">FragmentedMolecule</span><span class="w"> </span><span class="nf">frag_mol</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">molecule</span><span class="p">());</span>

<span class="k">for</span><span class="p">(</span><span class="n">NucleiView</span><span class="w"> </span><span class="n">frag_i</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">frag_nuclei</span><span class="p">){</span>
<span class="w">    </span><span class="c1">// Adds nuclei (and caps) and declares it as a neutral singlet</span>
<span class="w">    </span><span class="n">frag_mol</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">frag_i</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Step 4. Assign fields to each fragment</span>

<span class="c1">// This will hold the final fragments (which are each a ChemicalSystem)</span>
<span class="n">FragmentedChemicalSystem</span><span class="w"> </span><span class="n">frag_sys</span><span class="p">(</span><span class="n">sys</span><span class="p">);</span>

<span class="k">for</span><span class="p">(</span><span class="n">MoleculeView</span><span class="w"> </span><span class="n">frag_i</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">frag_mol</span><span class="p">){</span>
<span class="w"> </span><span class="c1">// Adds molecule and its external field</span>
<span class="w"> </span><span class="n">frag_sys</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">frag_i</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="fragmenting-design">
<h2>Fragmenting Design<a class="headerlink" href="#fragmenting-design" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="#fc-chemical-system-hierarchy"><span class="std std-ref">chemical system hierarchy</span></a> consideration
means that our architecture will need to mirror the chemical system hierarchy.
There’s at least two ways to do this:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code>, <code class="docutils literal notranslate"><span class="pre">FragmentedMolecule</span></code>, etc. or</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Fragmented&lt;Nuclei&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">Fragmented&lt;Molecule&gt;</span></code>, etc.</p></li>
</ul>
<p>Which brings us to the question “To template or not to template?”</p>
<p>A class template like <code class="docutils literal notranslate"><span class="pre">Fragmented&lt;T&gt;</span></code> works best if the same definition works
for most valid choices of <code class="docutils literal notranslate"><span class="pre">T</span></code>. If however <code class="docutils literal notranslate"><span class="pre">Fragmented&lt;T&gt;</span></code> would need to be
specialized for most valid choices of <code class="docutils literal notranslate"><span class="pre">T</span></code> there is little to gain over the
non-templated option. To this end we note the types differ in that:</p>
<ul class="simple">
<li><p>Fragmented <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> must worry about caps.</p></li>
<li><p>Fragmented <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> must worry about the electrons per fragment.</p></li>
<li><p>Fragmented <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> must worry about the fields per fragment.</p></li>
</ul>
<p>That said there’s also common aspects like:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Fragmented&lt;T&gt;</span></code> objects all store <code class="docutils literal notranslate"><span class="pre">T</span></code> objects.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Fragmented&lt;T&gt;</span></code> is container-like (i.e., needs <code class="docutils literal notranslate"><span class="pre">at</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, etc.)</p></li>
</ul>
<figure class="align-center" id="id3">
<span id="fig-fragmenting-overview"></span><img alt="../../../_images/overview.png" src="../../../_images/overview.png" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Architecture summary of the Fragmenting component of Chemist.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Ultimately we have opted for the architecture shown in
<a class="reference internal" href="#fig-fragmenting-overview"><span class="std std-numref">Fig. 8</span></a>. The major pieces are summarized below.</p>
<section id="fragmentedbase-class">
<h3>FragmentedBase Class<a class="headerlink" href="#fragmentedbase-class" title="Link to this heading"></a></h3>
<p>Full discussion: <a class="reference internal" href="fragmented_base.html#designing-fragmented-base-class"><span class="std std-ref">Designing the FragmentedBase Class</span></a></p>
<p>As we briefly touched on when debating whether to have a class template or not,
the containers of <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code>, <code class="docutils literal notranslate"><span class="pre">FragmentedMolecule</span></code>, and
<code class="docutils literal notranslate"><span class="pre">FragmentedChemicalSystem</span></code> have some common functionality, like accessing the
superset. The <code class="docutils literal notranslate"><span class="pre">FragmentedBase&lt;T&gt;</span></code> class template is introduced to factor out
common functionality. Here the template type parameter <code class="docutils literal notranslate"><span class="pre">T</span></code> is the class which
derives from <code class="docutils literal notranslate"><span class="pre">FragmentedBase&lt;T&gt;</span></code> and is used to implement
<code class="docutils literal notranslate"><span class="pre">FragmentedBase&lt;T&gt;</span></code> via the curiously recurring template pattern (CRTP). The
use of CRTP makes slicing unlikely.</p>
</section>
<section id="fragmentednuclei-class">
<h3>FragmentedNuclei Class<a class="headerlink" href="#fragmentednuclei-class" title="Link to this heading"></a></h3>
<p>Full discussion: <a class="reference internal" href="fragmented_nuclei.html#designing-fragmented-nuclei-class"><span class="std std-ref">Designing the FragmentedNuclei Class</span></a>.</p>
<p>Stemming from <a class="reference internal" href="#fc-chemical-system-hierarchy"><span class="std std-ref">chemical system hierarchy</span></a> we know we will have to
fragment each piece of the <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> hierarchy. The most fundamental
piece is the <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> part of the <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> class and the
<code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> class is charged with representing a fragmented
<code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> object. The <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> object determines whether the
fragments are disjoint or not. This is done based on whether or not any given
nucleus appears in more than one fragment. If a system contains caps, the nuclei
for those caps live in the <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> object.</p>
</section>
<section id="fragmentedmolecule-class">
<h3>FragmentedMolecule Class<a class="headerlink" href="#fragmentedmolecule-class" title="Link to this heading"></a></h3>
<p>Full discussion: <a class="reference internal" href="fragmented_molecule.html#designing-fragmented-molecule-class"><span class="std std-ref">Designing the FragmentedMolecule Class</span></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">FragmentedMolecule</span></code> class is responsible for holding fragments taken
from a <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> object. It is composed of a <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> object, the
charges of each fragment, and the multiplicities of each fragment.</p>
</section>
<section id="fragmentedchemicalsystem-class">
<h3>FragmentedChemicalSystem Class<a class="headerlink" href="#fragmentedchemicalsystem-class" title="Link to this heading"></a></h3>
<p>Full discussion: <a class="reference internal" href="fragmented_chemical_system.html#designing-fragmented-chemical-system-class"><span class="std std-ref">Designing the FragmentedChemicalSystem Class</span></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">FragmentedChemicalSystem</span></code> class is designed to hold fragments taken from
a <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> object. At present this simply entails holding a
<code class="docutils literal notranslate"><span class="pre">FragmentedMolecule</span></code> object, but will eventually include holding the fields
for each fragment as well.</p>
</section>
<section id="capping-component">
<h3>Capping Component<a class="headerlink" href="#capping-component" title="Link to this heading"></a></h3>
<p>Full discussion: <a class="reference internal" href="capping/index.html#capping-design"><span class="std std-ref">Capping Design</span></a>.</p>
<p>The last key piece of the Fragmenting component is the capping subcomponent
and its major classes: <code class="docutils literal notranslate"><span class="pre">Cap</span></code> and <code class="docutils literal notranslate"><span class="pre">CapSet</span></code>. Capping is introduced in response
to the <a class="reference internal" href="#fc-caps"><span class="std std-ref">caps</span></a> consideration. The use of a separate <code class="docutils literal notranslate"><span class="pre">CapSet</span></code> class, as
opposed to just adding the caps to a <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> object, facilitates telling the
caps from the “real” nuclei. Furthermore the caps have additional state beyond
that of a nucleus (or set of nuclei) including what nuclei they replace and what
nuclei they are attached to.</p>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h2>
<dl class="simple">
<dt><a class="reference internal" href="#fc-chemical-system-class"><span class="std std-ref">chemical system class</span></a></dt><dd><p>Fragmenting a <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> results in a container-like object of type
<code class="docutils literal notranslate"><span class="pre">FragmentedChemicalSystem</span></code>, the elements of the resulting object are
the fragments of the supersystem. Fragments are implicitly convertible to
<code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> references in order to leverage existing algorithms.</p>
</dd>
<dt><a class="reference internal" href="#fc-chemical-system-hierarchy"><span class="std std-ref">chemical system hierarchy</span></a></dt><dd><p>This consideration is essentially a generalization of
<a class="reference internal" href="#fc-chemical-system-class"><span class="std std-ref">chemical system class</span></a> and is addressed by <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code>,
<code class="docutils literal notranslate"><span class="pre">FragmentedMolecule</span></code>, and <code class="docutils literal notranslate"><span class="pre">FragmentedChemicalSystem</span></code>. Each of which maps
to a respective class in the <code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> class hierarchy.</p>
</dd>
<dt><a class="reference internal" href="#fc-caps"><span class="std std-ref">caps</span></a></dt><dd><p>The capping component is charged with representing the caps. The nuclei for
the caps are added to the system in the <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> object. The
electrons are added in the <code class="docutils literal notranslate"><span class="pre">FragmentedMolecule</span></code> object.</p>
</dd>
<dt><a class="reference internal" href="#fc-non-disjoint"><span class="std std-ref">non-disjoint fragments</span></a></dt><dd><p>This consideration is ultimately a design consideration of the
<code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> class.</p>
</dd>
<dt><a class="reference internal" href="#fc-general-use"><span class="std std-ref">general use</span></a></dt><dd><p>The Fragmenting component is largely made up of a container-like object and
objects supporting that container. The classes use generic language which is
widely applicable across scenarios.</p>
</dd>
</dl>
</section>
<section id="additional-notes">
<h2>Additional Notes<a class="headerlink" href="#additional-notes" title="Link to this heading"></a></h2>
<p>This design discussion was started as part of
<a class="reference external" href="https://github.com/NWChemEx/Chemist/pull/361">Chemist PR#361</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Design of the Fragmenting Component" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fragmented_base.html" class="btn btn-neutral float-right" title="Designing the FragmentedBase Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, NWChemEx Community.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>