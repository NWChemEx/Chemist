<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Designing the AOBasisSet Component &mdash; Chemist v1.3.19 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=2cf50c3e"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Design of the Topology Component" href="../topology/index.html" />
    <link rel="prev" title="Design of the AO Basis Set Component" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v1.3.19
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installing Chemist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../background/index.html">Chemist Background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Design Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../architecture.html">Architecture of Chemist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chemical_system/index.html">Design of the Chemical System Component</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Design of the AO Basis Set Component</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Designing the AOBasisSet Component</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../topology/index.html">Design of the Topology Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fragmenting/index.html">Design of the Fragmenting Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quantum_mechanics/index.html">Design of the Quantum Mechanics (QM) Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dsl.html">DSL Component</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developing_the_chemical_system_component.html">Developing the Chemical System Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../writing_views.html">Creating a New View</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../the_traits_component.html">Understanding the Traits Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../adding_an_operator.html">Notes on Adding an Operator</a></li>
<li class="toctree-l2"><a class="reference external" href="https://nwchemex.github.io/.github/">NWChemEx author documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Chemist Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex.github.io/Chemist/chemist_cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Chemist</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Developer Documentation</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Design Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Design of the AO Basis Set Component</a></li>
      <li class="breadcrumb-item active">Designing the AOBasisSet Component</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developer/design/ao_basis_set/ao_basis_set.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="designing-the-aobasisset-component">
<span id="designing-the-ao-basis-set-component"></span><h1>Designing the AOBasisSet Component<a class="headerlink" href="#designing-the-aobasisset-component" title="Link to this heading"></a></h1>
<p>Following from <a class="reference internal" href="../chemical_system/molecule.html#md-quantum-electrons"><span class="std std-ref">Quantum electrons.</span></a>, the <code class="docutils literal notranslate"><span class="pre">Atom</span></code>, <code class="docutils literal notranslate"><span class="pre">Molecule</span></code>, and
<code class="docutils literal notranslate"><span class="pre">ChemicalSystem</span></code> classes store their electrons implicitly. This usually
entails storing the number of electrons and the total spin. When it comes time
to model the actual electrons one needs to build wavefunctions (or densities).
The first step in this process is defining a basis set. For the purpose of this
page we assume that the basis set will be comprised of atom-centered atomic
orbitals (AOs).</p>
<section id="what-is-an-aobasisset">
<h2>What is an AOBasisSet?<a class="headerlink" href="#what-is-an-aobasisset" title="Link to this heading"></a></h2>
<p>AOs are the one-electron orbitals describing electrons within an atom. By an AO
basis set we mean a set of AOs used as a basis set for forming molecular
orbitals (MOs). The AO basis set is limited to representing the parameters
necessary to construct the set of AOs, <em>i.e.</em>, representing the space spanned
by the AOs is outside the scope of the <code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code> class (as detailed in
<a class="reference internal" href="../quantum_mechanics/wavefunction/architecture.html#architecture-of-wavefunction"><span class="std std-ref">Architecture of Wavefunction Component</span></a> representing this space falls to the
<code class="docutils literal notranslate"><span class="pre">AOSpace</span></code> class).</p>
</section>
<section id="why-do-we-need-an-aobasisset">
<h2>Why do we need an AOBasisSet?<a class="headerlink" href="#why-do-we-need-an-aobasisset" title="Link to this heading"></a></h2>
<p>To compute integrals involving AOs we must be able to construct the AOs. This
requires us to know the parameters defining those AOs. The <code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code> class
is a one-stop shop for those parameters. Most users will construct an
<code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code> (usually by specifying its name, <em>e.g.</em>, 6-31G*) and never need
to otherwise manipulate the AOBasisSet.</p>
</section>
<section id="aobasisset-considerations">
<span id="ao-basis-set-considerations"></span><h2>AOBasisSet Considerations<a class="headerlink" href="#aobasisset-considerations" title="Link to this heading"></a></h2>
<p>Topics in this section were considered in designing the AOBasisSet component
of Chemist and ultimately were addressed by the design.</p>
<dl class="simple" id="ao-bs-performance">
<dt>Performance</dt><dd><p>Integrals involving AOs are some of the lowest-lying operations. The
<code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code> needs to be interoperable with existing highly-optimized
integral libraries. In particular:</p>
<ul class="simple">
<li><p>Exponents, coefficients stored in a manner that is vectorizable.</p></li>
<li><p>float vs. double. Integrals are a performance critical piece of the code,
being able to use floats, instead of doubles, leads to significant speed
ups (when doing so does not compromise accuracy).</p></li>
<li><p>views also allow others to use existing basis sets seamlessly with our
infrastructure, without copying!</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="ao-spherical-vs-cartesian">
<dt>Spherical vs. Cartesian</dt><dd><p>Terming the <span class="math notranslate nohighlight">\(e^{-\alpha r^2}\)</span> part of a Gaussian basis function the
“radial” part, the angular part can take on one of two forms “spherical”
(in which case the radial/angular labels actually work) or “Cartesian” (in
which case the radial/angular labels are sloppy). We need to know this
information to properly compute the integrals.</p>
<ul class="simple">
<li><p>As a corollary, the distinction between spherical and Cartesian Gaussians
primarily impacts the integrals library. Consumers of the integrals only
care about the number of Gaussians. Point being, the design should adhere
to established norms that spherical/Cartesian Gaussians can be used largely
interchangeable.</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="ao-tracking-order">
<dt>Tracking Order</dt><dd><p>For tensors represented in an AO basis the order of the AOs will determine
the ordering of the tensor elements. For tensors to be compatible they
must have the same order. The AO basis set should be able to work out if
this is the case or not.</p>
<ul class="simple">
<li><p>This point is important to note because most other codes do NOT track this
information.</p></li>
<li><p>This information can be stored implicitly and only generated when needed.</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="ao-ao-to-center-mapping">
<dt>AO to Center Mapping</dt><dd><p>We usually center multiple AOs on the same point. Since the overlap of AOs
decays with the distance between them, the sparsity pattern tends to depend
on where AOs are centered. It is thus helpful to collect AOs on the same
center together.</p>
</dd>
</dl>
<dl class="simple" id="ao-atomic-basis-name">
<dt>Atomic Basis Name</dt><dd><p>Most of the time users use pre-tabulated AO basis set parameters. Convention
has established names for the various parameter sets, <em>e.g.</em>, STO-3G,
cc-pVDZ, and 6-31G*. While the parameters often suffice, there are
circumstances where we may need the name. Examples include: mapping to
auxillary basis sets, and interfacing with codes which do not expose
parameter-based APIs.</p>
<ul class="simple">
<li><p>We note that mixing basis sets, say using cc-pVDZ on hydrogens and
aug-cc-pVDZ on non-hydrogens, is not unheard of. Thus we may need to
specify the basis name per center.</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="ao-atomic-number">
<dt>Atomic number tracking</dt><dd><p>In practice one usually specifies an atomic basis set on a per atom basis.
This requires the name of the basis set and the atomic number of the atom.</p>
</dd>
</dl>
<dl class="simple" id="ao-hierarchical">
<dt>Hierarchical</dt><dd><p>While we think of atom-centered basis sets as simple sets of basis functions,
the reality is those functions have a somewhat complicated hierarchical
form, <em>i.e.</em>, primitives often combine to form contracted Gaussian functions
which then are paired with either a Cartesian or spherical piece to form
atomic orbitals which are then grouped into shells which are then grouped
into atomic basis sets which finally are combined to form molecular basis
sets. Our classes should also be able to represent this hierarchy.</p>
</dd>
</dl>
<dl class="simple" id="ao-class-flattening">
<dt>Class flattening</dt><dd><p>For better or worse much of the infrastructure written to support AO
integrals is function-based and not object-oriented. Point being to use an
object-oriented basis set with existing infrastructure we often need to
operate with the primitives directly. For convenience each level of the
hierarchy should be able to flatten itself, <em>i.e.</em>, we should be able to
iterate over primitives in an object, regardless of the nesting.</p>
</dd>
</dl>
<section id="out-of-scope">
<h3>Out of Scope<a class="headerlink" href="#out-of-scope" title="Link to this heading"></a></h3>
<p>Topics in this section were considered, but ultimately do not play a role in
the current implementation of the <code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code> class. Many of these
considerations may need to</p>
<dl class="simple">
<dt>Segmented vs general</dt><dd><p>Contracted Gaussians can come in two forms: segmented and general. Both are
linear combinations of primitive Gaussian functions. The difference is that
each segmented contracted Gaussian is comprised of different primitive
Gaussians, whereas with general contracted Gaussians multiple contractions
share the same primitives.</p>
<ul class="simple">
<li><p>The vast majority of existing infrastructure targets segmented
contractions so we have prioritized segmented contractions. While very
inefficient, one can use segmented basis infrastructure for general
contractions by copying the primitives.</p></li>
<li><p>An efficient solution would likely require writing a class parallel to
<code class="docutils literal notranslate"><span class="pre">Shell</span></code> which acts like a container of <code class="docutils literal notranslate"><span class="pre">ContractedGaussians</span></code>, but is
also keyed into the underlying general nature of the basis.</p></li>
</ul>
</dd>
<dt>Effective core potentials</dt><dd><p>For heavy atoms it is common to replace the core electrons with a potential.
In practice ECPs are basis set specific and thus have repercussions for the
basis set.</p>
<ul class="simple">
<li><p>ECPs will be needed down the road. A potential place for storing the ECP
is the <code class="docutils literal notranslate"><span class="pre">AtomicBasisSet</span></code> class.</p></li>
</ul>
</dd>
<dt>Not Gaussian-Based</dt><dd><p>AOs can be comprised of many types of functions. Atom-centered AOS are
overwhelming created from Gaussian functions and our current design
prioritizes Gaussian-based AOs.</p>
<ul class="simple">
<li><p>With some modifications the current design could be adapted to other AO
types, such as Slater orbitals. This would require introducing new classes
for the parameters of the other functions. It also may void some naming
conventions and would thus be API breaking.</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="aobasisset-design">
<h2>AOBasisSet Design<a class="headerlink" href="#aobasisset-design" title="Link to this heading"></a></h2>
<figure class="align-center" id="id1">
<span id="fig-ao-basis-set-design"></span><img alt="../../../_images/ao_basis_set.png" src="../../../_images/ao_basis_set.png" />
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Major classes involved in Chemist’s basis set component.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-ao-basis-set-design"><span class="std std-numref">Fig. 7</span></a> pictorially describes the AOBasisSet
component of Chemist. The top-level class is the <code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code> class (located
in the top-right corner of the diagram). The
remaining classes in the diagram form the internal, hierarchical structure of
the <code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code> class. The <code class="docutils literal notranslate"><span class="pre">AOBasisSet</span></code> class itself is little more than a
container of <code class="docutils literal notranslate"><span class="pre">AtomicBasisSet</span></code> objects.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">AtomicBasisSet</span></code> class groups AOs by center. This is
in response to consideration <a class="reference internal" href="#ao-ao-to-center-mapping"><span class="std std-ref">AO to Center Mapping</span></a>. More specifically,
all members of the same <code class="docutils literal notranslate"><span class="pre">AtomicBasisSet</span></code> object are centered on the same
point.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Shell</span></code> class represents all the AOs with a given total angular momentum
which can be formed from a <code class="docutils literal notranslate"><span class="pre">ContractedGaussian</span></code> object. At present, the AOs
in the <code class="docutils literal notranslate"><span class="pre">Shell</span></code> class are implicit and can not be individually accessed.
Allowing the user to directly access the <code class="docutils literal notranslate"><span class="pre">AO</span></code> objects would satisfy
consideration <a class="reference internal" href="#ao-tracking-order"><span class="std std-ref">Tracking Order</span></a>. In practice, the <code class="docutils literal notranslate"><span class="pre">Shell</span></code> class adds
two pieces of state: the total angular momentum and whether the AOs are
Cartesian or spherical (in turn satisfying <a class="reference internal" href="#ao-spherical-vs-cartesian"><span class="std std-ref">Spherical vs. Cartesian</span></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ContractedGaussian</span></code> class is a container around a set of <code class="docutils literal notranslate"><span class="pre">Primitive</span></code>
objects. The <code class="docutils literal notranslate"><span class="pre">Primitive</span></code> class holds the exponent, where the <code class="docutils literal notranslate"><span class="pre">Primitive</span></code>
is centered, and coefficient.</p>
<p>Not shown in <a class="reference internal" href="#fig-ao-basis-set-design"><span class="std std-numref">Fig. 7</span></a> are the respective view classes.
Associated with <code class="docutils literal notranslate"><span class="pre">Primitive</span></code>, <code class="docutils literal notranslate"><span class="pre">ContractedGaussian</span></code>, and <code class="docutils literal notranslate"><span class="pre">Shell</span></code> are
the classes <code class="docutils literal notranslate"><span class="pre">PrimitiveView</span></code>, <code class="docutils literal notranslate"><span class="pre">ContractedGaussianView</span></code>, and <code class="docutils literal notranslate"><span class="pre">ShellView</span></code>.
Additional views could be added for the <code class="docutils literal notranslate"><span class="pre">AO</span></code> class and the <code class="docutils literal notranslate"><span class="pre">AtomicBasisSet</span></code>
classes. Each view has the same API as its namesake class (<em>e.g.</em>,
<code class="docutils literal notranslate"><span class="pre">PrimitiveView</span></code> has the same API as <code class="docutils literal notranslate"><span class="pre">Primitive</span></code>), but different memory
ownership semantics. In particular, the view versions alias their state whereas
the non-views own it. The view versions are necessary to maintain an array-of-
structure API, while actually implementing a structure-of-arrays to be
consistent with <a class="reference internal" href="#ao-bs-performance"><span class="std std-ref">Performance</span></a>.</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h2>
<p>Briefly, the design of the AOBasisSet component addresses the considerations
raised in <a class="reference internal" href="#ao-basis-set-considerations"><span class="std std-ref">AOBasisSet Considerations</span></a> by:</p>
<dl class="simple">
<dt><a class="reference internal" href="#ao-bs-performance"><span class="std std-ref">Performance</span></a></dt><dd><p>Our design addresses performance primarily by a separation of the API from
the implementation. More specifically, the containers behave like arrays of
structures, but under the hood are implemented as structures of arrays. The
trick</p>
</dd>
<dt><a class="reference internal" href="#ao-spherical-vs-cartesian"><span class="std std-ref">Spherical vs. Cartesian</span></a></dt><dd><p>The design contains two provisions for spherical AOs vs. Cartesian AOs.
The first is in the <code class="docutils literal notranslate"><span class="pre">CartesianAO</span></code> and <code class="docutils literal notranslate"><span class="pre">SphericalAO</span></code> classes which are
envisioned as providing direct access to the parameters defining a
particular AO. The second is the <code class="docutils literal notranslate"><span class="pre">Shell</span></code> class which knows if the AOs
forming the shell are spherical or Cartesian.</p>
</dd>
<dt><a class="reference internal" href="#ao-tracking-order"><span class="std std-ref">Tracking Order</span></a></dt><dd><p>The design calls for the <code class="docutils literal notranslate"><span class="pre">AO</span></code>, <code class="docutils literal notranslate"><span class="pre">CartesianAO</span></code>, and <code class="docutils literal notranslate"><span class="pre">SphericalAO</span></code>
classes, which can be used to iterate over the AOs in a <code class="docutils literal notranslate"><span class="pre">Shell</span></code>.</p>
</dd>
<dt><a class="reference internal" href="#ao-ao-to-center-mapping"><span class="std std-ref">AO to Center Mapping</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">AtomicBasisSet</span></code> class stores all of the AOs (grouped into shells)
which reside on the same center.</p>
</dd>
<dt><a class="reference internal" href="#ao-atomic-basis-name"><span class="std std-ref">Atomic Basis Name</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">AtomicBasisSet</span></code> class is capable of storing the name of the basis
set.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Design of the AO Basis Set Component" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../topology/index.html" class="btn btn-neutral float-right" title="Design of the Topology Component" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, NWChemEx Community.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>